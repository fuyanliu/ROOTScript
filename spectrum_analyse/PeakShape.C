/*
 * subroutine to display peak shape
 */

#define MAX(s1,s2)  (s1)>(s2)?(s1):(s2)
void  PeakShape(int k=16)
{

    double peakshape[17][64]= { { 5.102856e-016,  3.758765e-015,  2.600959e-014,  1.690747e-013,  1.032476e-012,  5.922953e-012,  3.191927e-011,  1.615937e-010,  7.685150e-010,  3.433499e-009,  1.441047e-008,  5.681667e-008,  2.104409e-007,  7.322191e-007,  2.393363e-006,  7.349076e-006,  2.119890e-005,  5.744481e-005,  1.462327e-004,  3.496996e-004,  7.856014e-004,  1.657929e-003,  3.286898e-003,  6.121574e-003,  1.071018e-002,  1.760300e-002,  2.717899e-002,  3.942181e-002,  5.371511e-002,  6.875636e-002,  8.267724e-002,  9.339327e-002,  9.910642e-002,  9.879719e-002,  9.252180e-002,  8.139544e-002,  6.726865e-002,  5.222542e-002,  3.808971e-002,  2.609697e-002,  1.679690e-002,  1.015605e-002,  5.768686e-003,  3.078121e-003,  1.542947e-003,  7.265625e-004,  3.214042e-004,  1.335632e-004,  5.214089e-005,  1.912172e-005,  6.587669e-006,  2.132030e-006,  6.482036e-007,  1.851340e-007,  4.967267e-008,  1.252003e-008,  2.964489e-009,  6.594031e-010,  1.377871e-010,  2.704724e-011,  4.987626e-012,  0.000000e+000,  1.406065e-013,  2.149543e-014},
        { 5.102856e-016,  3.758765e-015,  2.600959e-014,  1.690747e-013,  1.032476e-012,  5.922953e-012,  3.191927e-011,  1.615937e-010,  7.685150e-010,  3.433499e-009,  1.441047e-008,  5.681667e-008,  2.104409e-007,  7.322191e-007,  2.393363e-006,  7.349076e-006,  2.119890e-005,  5.744481e-005,  1.462327e-004,  3.496996e-004,  7.856014e-004,  1.657929e-003,  3.286898e-003,  6.121574e-003,  1.071018e-002,  1.760300e-002,  2.717899e-002,  3.942181e-002,  5.371511e-002,  6.875636e-002,  8.267724e-002,  9.339327e-002,  9.910642e-002,  9.879719e-002,  9.252180e-002,  8.139544e-002,  6.726865e-002,  5.222542e-002,  3.808971e-002,  2.609697e-002,  1.679690e-002,  1.015605e-002,  5.768686e-003,  3.078121e-003,  1.542947e-003,  7.265625e-004,  3.214042e-004,  1.335632e-004,  5.214089e-005,  1.912172e-005,  6.587669e-006,  2.132030e-006,  6.482036e-007,  1.851340e-007,  4.967267e-008,  1.252003e-008,  2.964489e-009,  6.594031e-010,  1.377871e-010,  2.704724e-011,  4.987626e-012,  0.000000e+000,  1.406065e-013,  2.149543e-014},
        { 5.102856e-016,  3.758765e-015,  2.600959e-014,  1.690747e-013,  1.032476e-012,  5.922953e-012,  3.191927e-011,  1.615937e-010,  7.685150e-010,  3.433499e-009,  1.441047e-008,  5.681667e-008,  2.104409e-007,  7.322191e-007,  2.393363e-006,  7.349076e-006,  2.119890e-005,  5.744481e-005,  1.462327e-004,  3.496996e-004,  7.856014e-004,  1.657929e-003,  3.286898e-003,  6.121574e-003,  1.071018e-002,  1.760300e-002,  2.717899e-002,  3.942181e-002,  5.371511e-002,  6.875636e-002,  8.267724e-002,  9.339327e-002,  9.910642e-002,  9.879719e-002,  9.252180e-002,  8.139544e-002,  6.726865e-002,  5.222542e-002,  3.808971e-002,  2.609697e-002,  1.679690e-002,  1.015605e-002,  5.768686e-003,  3.078121e-003,  1.542947e-003,  7.265625e-004,  3.214042e-004,  1.335632e-004,  5.214089e-005,  1.912172e-005,  6.587669e-006,  2.132030e-006,  6.482036e-007,  1.851340e-007,  4.967267e-008,  1.252003e-008,  2.964489e-009,  6.594031e-010,  1.377871e-010,  2.704724e-011,  4.987626e-012,  0.000000e+000,  1.406065e-013,  2.149543e-014},
        { 5.102856e-016,  3.758765e-015,  2.600959e-014,  1.690747e-013,  1.032476e-012,  5.922953e-012,  3.191927e-011,  1.615937e-010,  7.685150e-010,  3.433499e-009,  1.441047e-008,  5.681667e-008,  2.104409e-007,  7.322191e-007,  2.393363e-006,  7.349076e-006,  2.119890e-005,  5.744481e-005,  1.462327e-004,  3.496996e-004,  7.856014e-004,  1.657929e-003,  3.286898e-003,  6.121574e-003,  1.071018e-002,  1.760300e-002,  2.717899e-002,  3.942181e-002,  5.371511e-002,  6.875636e-002,  8.267724e-002,  9.339327e-002,  9.910642e-002,  9.879719e-002,  9.252180e-002,  8.139544e-002,  6.726865e-002,  5.222542e-002,  3.808971e-002,  2.609697e-002,  1.679690e-002,  1.015605e-002,  5.768686e-003,  3.078121e-003,  1.542947e-003,  7.265625e-004,  3.214042e-004,  1.335632e-004,  5.214089e-005,  1.912172e-005,  6.587669e-006,  2.132030e-006,  6.482036e-007,  1.851340e-007,  4.967267e-008,  1.252003e-008,  2.964489e-009,  6.594031e-010,  1.377871e-010,  2.704724e-011,  4.987626e-012,  0.000000e+000,  1.406065e-013,  2.149543e-014},
        { 5.102856e-016,  3.758765e-015,  2.600959e-014,  1.690747e-013,  1.032476e-012,  5.922953e-012,  3.191927e-011,  1.615937e-010,  7.685150e-010,  3.433499e-009,  1.441047e-008,  5.681667e-008,  2.104409e-007,  7.322191e-007,  2.393363e-006,  7.349076e-006,  2.119890e-005,  5.744481e-005,  1.462327e-004,  3.496996e-004,  7.856014e-004,  1.657929e-003,  3.286898e-003,  6.121574e-003,  1.071018e-002,  1.760300e-002,  2.717899e-002,  3.942181e-002,  5.371511e-002,  6.875636e-002,  8.267724e-002,  9.339327e-002,  9.910642e-002,  9.879719e-002,  9.252180e-002,  8.139544e-002,  6.726865e-002,  5.222542e-002,  3.808971e-002,  2.609697e-002,  1.679690e-002,  1.015605e-002,  5.768686e-003,  3.078121e-003,  1.542947e-003,  7.265625e-004,  3.214042e-004,  1.335632e-004,  5.214089e-005,  1.912172e-005,  6.587669e-006,  2.132030e-006,  6.482036e-007,  1.851340e-007,  4.967267e-008,  1.252003e-008,  2.964489e-009,  6.594031e-010,  1.377871e-010,  2.704724e-011,  4.987626e-012,  0.000000e+000,  1.406065e-013,  2.149543e-014},
        { 5.102856e-016,  3.758765e-015,  2.600959e-014,  1.690747e-013,  1.032476e-012,  5.922953e-012,  3.191927e-011,  1.615937e-010,  7.685150e-010,  3.433499e-009,  1.441047e-008,  5.681667e-008,  2.104409e-007,  7.322191e-007,  2.393363e-006,  7.349076e-006,  2.119890e-005,  5.744481e-005,  1.462327e-004,  3.496996e-004,  7.856014e-004,  1.657929e-003,  3.286898e-003,  6.121574e-003,  1.071018e-002,  1.760300e-002,  2.717899e-002,  3.942181e-002,  5.371511e-002,  6.875636e-002,  8.267724e-002,  9.339327e-002,  9.910642e-002,  9.879719e-002,  9.252180e-002,  8.139544e-002,  6.726865e-002,  5.222542e-002,  3.808971e-002,  2.609697e-002,  1.679690e-002,  1.015605e-002,  5.768686e-003,  3.078121e-003,  1.542947e-003,  7.265625e-004,  3.214042e-004,  1.335632e-004,  5.214089e-005,  1.912172e-005,  6.587669e-006,  2.132030e-006,  6.482036e-007,  1.851340e-007,  4.967267e-008,  1.252003e-008,  2.964489e-009,  6.594031e-010,  1.377871e-010,  2.704724e-011,  4.987626e-012,  0.000000e+000,  1.406065e-013,  2.149543e-014},
        { 5.102856e-016,  3.758765e-015,  2.600959e-014,  1.690747e-013,  1.032476e-012,  5.922953e-012,  3.191927e-011,  1.615937e-010,  7.685150e-010,  3.433499e-009,  1.441047e-008,  5.681667e-008,  2.104409e-007,  7.322191e-007,  2.393363e-006,  7.349076e-006,  2.119890e-005,  5.744481e-005,  1.462327e-004,  3.496996e-004,  7.856014e-004,  1.657929e-003,  3.286898e-003,  6.121574e-003,  1.071018e-002,  1.760300e-002,  2.717899e-002,  3.942181e-002,  5.371511e-002,  6.875636e-002,  8.267724e-002,  9.339327e-002,  9.910642e-002,  9.879719e-002,  9.252180e-002,  8.139544e-002,  6.726865e-002,  5.222542e-002,  3.808971e-002,  2.609697e-002,  1.679690e-002,  1.015605e-002,  5.768686e-003,  3.078121e-003,  1.542947e-003,  7.265625e-004,  3.214042e-004,  1.335632e-004,  5.214089e-005,  1.912172e-005,  6.587669e-006,  2.132030e-006,  6.482036e-007,  1.851340e-007,  4.967267e-008,  1.252003e-008,  2.964489e-009,  6.594031e-010,  1.377871e-010,  2.704724e-011,  4.987626e-012,  0.000000e+000,  1.406065e-013,  2.149543e-014},
        { 5.102856e-016,  3.758765e-015,  2.600959e-014,  1.690747e-013,  1.032476e-012,  5.922953e-012,  3.191927e-011,  1.615937e-010,  7.685150e-010,  3.433499e-009,  1.441047e-008,  5.681667e-008,  2.104409e-007,  7.322191e-007,  2.393363e-006,  7.349076e-006,  2.119890e-005,  5.744481e-005,  1.462327e-004,  3.496996e-004,  7.856014e-004,  1.657929e-003,  3.286898e-003,  6.121574e-003,  1.071018e-002,  1.760300e-002,  2.717899e-002,  3.942181e-002,  5.371511e-002,  6.875636e-002,  8.267724e-002,  9.339327e-002,  9.910642e-002,  9.879719e-002,  9.252180e-002,  8.139544e-002,  6.726865e-002,  5.222542e-002,  3.808971e-002,  2.609697e-002,  1.679690e-002,  1.015605e-002,  5.768686e-003,  3.078121e-003,  1.542947e-003,  7.265625e-004,  3.214042e-004,  1.335632e-004,  5.214089e-005,  1.912172e-005,  6.587669e-006,  2.132030e-006,  6.482036e-007,  1.851340e-007,  4.967267e-008,  1.252003e-008,  2.964489e-009,  6.594031e-010,  1.377871e-010,  2.704724e-011,  4.987626e-012,  0.000000e+000,  1.406065e-013,  2.149543e-014},
        { 5.102856e-016,  3.758765e-015,  2.600959e-014,  1.690747e-013,  1.032476e-012,  5.922953e-012,  3.191927e-011,  1.615937e-010,  7.685150e-010,  3.433499e-009,  1.441047e-008,  5.681667e-008,  2.104409e-007,  7.322191e-007,  2.393363e-006,  7.349076e-006,  2.119890e-005,  5.744481e-005,  1.462327e-004,  3.496996e-004,  7.856014e-004,  1.657929e-003,  3.286898e-003,  6.121574e-003,  1.071018e-002,  1.760300e-002,  2.717899e-002,  3.942181e-002,  5.371511e-002,  6.875636e-002,  8.267724e-002,  9.339327e-002,  9.910642e-002,  9.879719e-002,  9.252180e-002,  8.139544e-002,  6.726865e-002,  5.222542e-002,  3.808971e-002,  2.609697e-002,  1.679690e-002,  1.015605e-002,  5.768686e-003,  3.078121e-003,  1.542947e-003,  7.265625e-004,  3.214042e-004,  1.335632e-004,  5.214089e-005,  1.912172e-005,  6.587669e-006,  2.132030e-006,  6.482036e-007,  1.851340e-007,  4.967267e-008,  1.252003e-008,  2.964489e-009,  6.594031e-010,  1.377871e-010,  2.704724e-011,  4.987626e-012,  0.000000e+000,  1.406065e-013,  2.149543e-014},
        { 0.000000e+000,  3.018661e-006,  6.037322e-006,  1.385343e-005,  2.166955e-005,  3.810487e-005,  5.454019e-005,  9.397652e-005,  1.334128e-004,  1.535678e-004,  1.737227e-004,  3.840427e-004,  5.943627e-004,  1.523526e-003,  2.452688e-003,  5.691532e-003,  8.930376e-003,  1.726357e-002,  2.559677e-002,  4.055950e-002,  5.552223e-002,  7.308915e-002,  9.065606e-002,  1.001103e-001,  1.095645e-001,  1.034882e-001,  9.741194e-002,  8.058955e-002,  6.376715e-002,  4.718822e-002,  3.060929e-002,  2.071020e-002,  1.081110e-002,  6.822596e-003,  2.834089e-003,  1.703412e-003,  5.727354e-004,  3.388861e-004,  1.050367e-004,  1.040082e-004,  1.029797e-004,  7.094030e-005,  3.890092e-005,  2.984494e-005,  2.078896e-005,  1.628034e-005,  1.177172e-005,  9.795678e-006,  7.819635e-006,  3.909818e-006,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  1.220000e+002,  3.559586e+000,  2.418746e+001},
        { 2.600959e-014,  1.690747e-013,  1.032476e-012,  5.922953e-012,  3.191927e-011,  1.615937e-010,  7.685150e-010,  3.433499e-009,  1.441047e-008,  5.681667e-008,  2.104409e-007,  7.322191e-007,  2.393363e-006,  7.349076e-006,  2.119890e-005,  5.744481e-005,  1.462327e-004,  3.496996e-004,  7.856014e-004,  1.657929e-003,  3.286898e-003,  6.121574e-003,  1.071018e-002,  1.760300e-002,  2.717899e-002,  3.942181e-002,  5.371511e-002,  6.875636e-002,  8.267724e-002,  9.339327e-002,  9.910642e-002,  9.879719e-002,  9.252180e-002,  8.139544e-002,  6.726865e-002,  5.222542e-002,  3.808971e-002,  2.609697e-002,  1.679690e-002,  1.015605e-002,  5.768686e-003,  3.078121e-003,  1.542947e-003,  7.265625e-004,  3.214042e-004,  1.335632e-004,  5.214089e-005,  1.912172e-005,  6.587669e-006,  2.132030e-006,  6.482036e-007,  1.851340e-007,  4.967267e-008,  1.252003e-008,  2.964489e-009,  6.594031e-010,  1.377871e-010,  2.704724e-011,  4.987626e-012,  8.640152e-013,  1.406065e-013,  4.000000e+002,  4.000000e+000,  3.000000e+001},
        { 0.000000e+000,  5.837169e-005,  6.780097e-005,  7.274011e-005,  1.077631e-004,  1.086612e-004,  1.095592e-004,  1.109062e-004,  1.369490e-004,  1.733190e-004,  2.514473e-004,  4.440739e-004,  6.744175e-004,  1.134207e-003,  1.504194e-003,  3.311471e-003,  6.560080e-003,  1.334691e-002,  2.571946e-002,  4.456230e-002,  7.067016e-002,  9.909492e-002,  1.240802e-001,  1.353617e-001,  1.358713e-001,  1.162742e-001,  9.015732e-002,  6.013406e-002,  3.556632e-002,  1.878670e-002,  8.623295e-003,  3.659456e-003,  1.389695e-003,  9.483154e-004,  4.270113e-004,  1.845443e-004,  1.122532e-004,  7.049504e-005,  5.971873e-005,  4.355426e-005,  3.008387e-005,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  6.620000e+002,  2.817238e+000,  2.324227e+001},
        { 0.000000e+000,  1.462157e-004,  1.685781e-004,  1.788992e-004,  2.004015e-004,  2.219038e-004,  2.348051e-004,  4.575690e-004,  7.611816e-004,  1.175746e-003,  1.965311e-003,  2.687788e-003,  5.698110e-003,  9.473915e-003,  1.729215e-002,  2.724342e-002,  4.178328e-002,  5.786270e-002,  7.573972e-002,  9.378015e-002,  1.065869e-001,  1.101692e-001,  1.064665e-001,  9.704420e-002,  7.842320e-002,  6.008604e-002,  4.167147e-002,  2.578556e-002,  1.525803e-002,  8.304190e-003,  4.799314e-003,  2.279244e-003,  1.346044e-003,  9.159982e-004,  5.452984e-004,  4.644498e-004,  3.793006e-004,  3.517777e-004,  2.838304e-004,  2.709290e-004,  2.365253e-004,  2.279244e-004,  2.072822e-004,  2.064221e-004,  2.038418e-004,  1.479359e-004,  1.470758e-004,  1.195528e-004,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  1.173000e+003,  3.498324e+000,  2.099979e+001},
        { 0.000000e+000,  8.789940e-006,  1.328258e-005,  1.416157e-005,  1.572423e-005,  1.836121e-005,  2.715115e-005,  5.342330e-005,  7.617948e-005,  9.092704e-005,  1.007913e-004,  1.313608e-004,  1.725758e-004,  2.391840e-004,  3.144845e-004,  4.512169e-004,  8.418809e-004,  1.450340e-003,  2.656515e-003,  4.528772e-003,  8.243986e-003,  1.406488e-002,  2.317028e-002,  3.562074e-002,  5.124047e-002,  6.817868e-002,  8.569898e-002,  1.001653e-001,  1.085450e-001,  1.088497e-001,  1.014134e-001,  8.643734e-002,  6.872268e-002,  4.992100e-002,  3.361468e-002,  2.078332e-002,  1.184298e-002,  6.295550e-003,  3.176098e-003,  1.338024e-003,  6.387356e-004,  3.924220e-004,  1.850771e-004,  9.434535e-005,  5.840426e-005,  3.672241e-005,  2.724881e-005,  2.002153e-005,  1.875187e-005,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  1.274000e+003,  3.465356e+000,  2.837680e+001},
        { 0.000000e+000,  8.984700e-005,  1.046569e-004,  1.244035e-004,  1.609347e-004,  1.619220e-004,  2.468324e-004,  2.665790e-004,  2.942242e-004,  3.297681e-004,  3.406287e-004,  4.709562e-004,  5.578412e-004,  8.066482e-004,  1.244035e-003,  1.540234e-003,  3.396414e-003,  5.923977e-003,  1.007076e-002,  1.599474e-002,  2.472767e-002,  3.785915e-002,  5.209151e-002,  6.942408e-002,  8.256049e-002,  9.620046e-002,  1.012852e-001,  1.032006e-001,  9.510946e-002,  8.663817e-002,  6.738031e-002,  5.011685e-002,  3.518349e-002,  2.391806e-002,  1.397565e-002,  7.533324e-003,  4.215897e-003,  2.330098e-003,  1.283528e-003,  8.698373e-004,  5.252594e-004,  3.702486e-004,  2.734903e-004,  1.984532e-004,  1.559981e-004,  1.372388e-004,  1.174922e-004,  1.125556e-004,  7.997370e-005,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  1.332000e+003,  3.714695e+000,  2.636504e+001},
        { 0.000000e+000,  1.286115e-004,  1.787482e-004,  2.506834e-004,  2.877409e-004,  3.945539e-004,  4.621294e-004,  6.059998e-004,  8.348847e-004,  1.216359e-003,  1.920453e-003,  2.790215e-003,  4.555898e-003,  7.411509e-003,  1.109547e-002,  1.772223e-002,  2.639805e-002,  3.738452e-002,  4.882877e-002,  6.190790e-002,  7.799523e-002,  8.985365e-002,  9.711257e-002,  9.719976e-002,  9.323242e-002,  8.381545e-002,  7.058372e-002,  5.477977e-002,  3.991316e-002,  2.846891e-002,  1.818000e-002,  1.159683e-002,  5.798416e-003,  3.247985e-003,  2.044705e-003,  1.000554e-003,  4.337913e-004,  2.027266e-004,  1.024532e-004,  6.321582e-005,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  0.000000e+000,  1.597000e+003,  4.044953e+000,  2.250574e+001},
        { 6.987123e-014,  4.376489e-013,  2.575901e-012,  1.424654e-011,  7.404031e-011,  3.615817e-010,  1.659301e-009,  7.155268e-009,  2.899408e-008,  1.104019e-007,  3.950290e-007,  1.328212e-006,  4.196550e-006,  1.245964e-005,  3.476218e-005,  9.113770e-005,  2.245327e-004,  5.198189e-004,  1.130879e-003,  2.311920e-003,  4.441427e-003,  8.017994e-003,  1.360201e-002,  2.168377e-002,  3.248341e-002,  4.572814e-002,  6.049245e-002,  7.519945e-002,  8.784642e-002,  9.643389e-002,  9.947903e-002,  9.643390e-002,  8.784642e-002,  7.519944e-002,  6.049246e-002,  4.572814e-002,  3.248341e-002,  2.168377e-002,  1.360201e-002,  8.017994e-003,  4.441427e-003,  2.311920e-003,  1.130879e-003,  5.198189e-004,  2.245327e-004,  9.113770e-005,  3.476218e-005,  1.245964e-005,  4.196550e-006,  1.328212e-006,  3.950290e-007,  1.104019e-007,  2.899408e-008,  7.155267e-009,  1.659301e-009,  3.615817e-010,  7.404031e-011,  1.424654e-011,  2.575901e-012,  4.376489e-013,  6.987123e-014,  8.000000e+003,  4.000000e+000,  3.022446e+001}
    };
    double y01,*pd,ry;
    double cc;
    int n=60;
    double *x=new double[n];
    double *y=new double[n];
    int nchk=k;

        pd=peakshape[nchk];
        cc=0.0;
        for (int i=3; i<=60 ; i++) {
            cc=MAX(cc,*(pd+i));
        }

        for (int i=1; i<=60; i++) {
            x[i-1]=i;
            y01=*(pd+i)/cc;
            y[i-1]=y01;
        }

    TGraph *gr=new TGraph(n,x,y);
    gr->Draw("AC*");
    //return (0);
}
